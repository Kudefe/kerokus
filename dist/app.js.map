{"version":3,"sources":["../server/app.js"],"names":["connect","database","db","connection","once","console","log","on","err","app","set","__dirname","engine","defaultLayout","use","urlencoded","extended","json","static","join","secret","resave","saveUninitialized","errorFormatter","param","msg","value","namespace","split","root","shift","formParam","length","require","initialize","session","get","req","res","next","locals","user","flash","redirect"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,mBAASA,OAAT,CAAiB,mBAAOC,QAAxB;AACA,IAAIC,KAAK,mBAASC,UAAlB;;AAEA;AACAD,GAAGE,IAAH,CAAQ,MAAR,EAAgB,YAAO;AACrBC,UAAQC,GAAR,CAAY,qBAAZ;AACD,CAFD;;AAIA;AACAJ,GAAGK,EAAH,CAAM,OAAN,EAAe,UAACC,GAAD,EAAS;AACtBH,UAAQC,GAAR,CAAYE,GAAZ;AACD,CAFD;;AAIA,IAAMC,MAAM,wBAAZ;;AAEAA,IAAIC,GAAJ,CAAQ,OAAR,EAAiBC,YAAY,YAA7B;;AAEAF,IAAIG,MAAJ,CAAW,YAAX,EAAyB,iCAAO,EAACC,eAAe,MAAhB,EAAP,CAAzB;AACAJ,IAAIC,GAAJ,CAAQ,aAAR,EAAuB,YAAvB;;AAEA;AACAD,IAAIK,GAAJ,CAAQ,qBAAWC,UAAX,CAAsB,EAAEC,UAAU,KAAZ,EAAtB,CAAR;;AAEA;AACAP,IAAIK,GAAJ,CAAQ,qBAAWG,IAAX,EAAR;;AAEA;AACAR,IAAIK,GAAJ,CAAQ,kBAAQI,MAAR,CAAe,eAAKC,IAAL,CAAUR,SAAV,EAAqB,aAArB,CAAf,CAAR;;AAEAF,IAAIK,GAAJ,CAAQ,sBAAO,KAAP,CAAR;;AAEAL,IAAIK,GAAJ,CAAQ,4BAAa,cAAb,CAAR;;AAEAL,IAAIK,GAAJ,CAAQ,8BAAQ;AACdM,UAAQ,cADM;AAEdC,UAAQ,IAFM;AAGdC,qBAAkB;AAHJ,CAAR,CAAR;;AAMAb,IAAIK,GAAJ,CAAQ,6BAAR;;AAEAL,IAAIK,GAAJ,CAAQ,gCAAiB;AACvBS,kBAAgB,wBAASC,KAAT,EAAgBC,GAAhB,EAAqBC,KAArB,EAA4B;AACxC,QAAIC,YAAYH,MAAMI,KAAN,CAAY,GAAZ,CAAhB;AAAA,QACEC,OAAUF,UAAUG,KAAV,EADZ;AAAA,QAEEC,YAAYF,IAFd;;AAIF,WAAMF,UAAUK,MAAhB,EAAwB;AACtBD,mBAAa,MAAMJ,UAAUG,KAAV,EAAN,GAA0B,GAAvC;AACD;AACD,WAAO;AACLN,aAAQO,SADH;AAELN,WAAQA,GAFH;AAGLC,aAAQA;AAHH,KAAP;AAKD;AAdsB,CAAjB,CAAR;;AAiBAO,QAAQ,mBAAR;AACA;AACAxB,IAAIK,GAAJ,CAAQ,mBAASoB,UAAT,EAAR;AACAzB,IAAIK,GAAJ,CAAQ,mBAASqB,OAAT,EAAR;;AAEA;AACA1B,IAAI2B,GAAJ,CAAQ,GAAR,EAAa,UAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC/BD,MAAIE,MAAJ,CAAWC,IAAX,GAAkBJ,IAAII,IAAJ,IAAY,IAA9B;AACAF;AACD,CAHD;;AAKA9B,IAAI2B,GAAJ,CAAQ,QAAR,EAAkB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC9BA,MAAII,KAAJ,CAAU,MAAV,EAAkB,mBAAlB;AACAJ,MAAIK,QAAJ,CAAa,QAAb;AACD,CAHD;;AAKAlC,IAAI2B,GAAJ,CAAQ,WAAR,EAAqB,UAACC,GAAD,EAAMC,GAAN,EAAc;AACjCA,MAAIK,QAAJ,CAAa,QAAb;AACD,CAFD;;AAIAlC,IAAI2B,GAAJ,CAAQ,OAAR,EAAiB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC7BA,MAAII,KAAJ,CAAU,MAAV,EAAkB,gBAAlB;AACAJ,MAAIK,QAAJ,CAAa,QAAb;AACD,CAHD;;AAKAlC,IAAIK,GAAJ,CAAQ,GAAR;;kBAEeL,G","file":"app.js","sourcesContent":["import express from 'express'\r\nimport mongoose from 'mongoose'\r\nimport routes from './routes'\r\nimport util from 'util'\r\nimport exphbs from 'express-handlebars'\r\nimport path from 'path'\r\nimport logger from 'morgan'\r\nimport cookieParser from 'cookie-parser'\r\nimport bodyParser from 'body-parser'\r\nimport session from 'express-session'\r\nimport flash from 'express-flash-2'\r\nimport expressValidator from 'express-validator'\r\nimport config from './config/database'\r\nimport passport from 'passport'\r\n\r\nmongoose.connect(config.database)\r\nlet db = mongoose.connection\r\n\r\n//check connection\r\ndb.once('open', ()  => {\r\n  console.log('conectado a mongoDB');\r\n})\r\n\r\n//check for db errors\r\ndb.on('error', (err) => {\r\n  console.log(err);\r\n})\r\n\r\nconst app = express()\r\n\r\napp.set('views', __dirname + './../views')\r\n\r\napp.engine('handlebars', exphbs({defaultLayout: 'main'}))\r\napp.set('view engine', 'handlebars')\r\n\r\n// parse application/x-www-form-urlencoded\r\napp.use(bodyParser.urlencoded({ extended: false }))\r\n\r\n// parse application/json\r\napp.use(bodyParser.json())\r\n\r\n//set public folder\r\napp.use(express.static(path.join(__dirname, './../public')))\r\n\r\napp.use(logger('dev'))\r\n\r\napp.use(cookieParser('keyboard cat'))\r\n\r\napp.use(session({\r\n  secret: 'keyboard cat',\r\n  resave: true,\r\n  saveUninitialized:true\r\n}))\r\n\r\napp.use(flash());\r\n\r\napp.use(expressValidator({\r\n  errorFormatter: function(param, msg, value) {\r\n      var namespace = param.split('.')\r\n      , root    = namespace.shift()\r\n      , formParam = root;\r\n\r\n    while(namespace.length) {\r\n      formParam += '[' + namespace.shift() + ']';\r\n    }\r\n    return {\r\n      param : formParam,\r\n      msg   : msg,\r\n      value : value\r\n    };\r\n  }\r\n}));\r\n\r\nrequire('./config/passport')(passport)\r\n//passport middleware\r\napp.use(passport.initialize());\r\napp.use(passport.session());\r\n\r\n//Route global para mandar a todos los views un user\r\napp.get('*', (req, res, next) => {\r\n  res.locals.user = req.user || null\r\n  next()\r\n})\r\n\r\napp.get('/flash', (req, res) => {\r\n  res.flash('info', 'no se que chucha!')\r\n  res.redirect('/games')\r\n})\r\n\r\napp.get('/no-flash', (req, res) => {\r\n  res.redirect('/games')\r\n})\r\n\r\napp.get('/otro', (req, res) => {\r\n  res.flash('info', 'soy otro flash')\r\n  res.redirect('/games')\r\n})\r\n\r\napp.use('/', routes)\r\n\r\nexport default app\r\n"]}